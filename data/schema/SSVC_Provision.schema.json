{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://certcc.github.io/SSVC/data/schema/SSVC_Provision.schema.json",
    "title": "Decision tree schema definition for SSVC",
    "description": "This provides a schema for a decision tree used to compute SSVC score for a vulnerability",
    "type": "object",    
    "properties": {
	"decision_points": { "$ref": "https://certcc.github.io/SSVC/data/schema/Decision_Point_Group.schema.json#/properties/decision_points" },
        "decisions_table": {
            "type": "array",		
            "items": {
                "type": "object"
            },
            "minItems": 1,
            "type": "array"
        },	
        "lang": {
            "maxLength": 7,
            "type": "string"
        },
	"roles": {
	    "description": "Roles as described in SSVC as distinct array elements",
	    "type": "array",
	    "items": {
		"type": "string"
	    },
	    "minItems": 1,
	    "uniqueItems": true
	},
        "title": {
            "maxLength": 255,
            "type": "string"
        },
        "version": {
            "enum": [
                "1.0",
                "2.0"
            ]
        }
    },
    "required": [
        "lang",
        "version",
        "decision_points",
        "decisions_table"
    ],
    "additionalProperties": false
}

