{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://certcc.github.io/SSVC/data/schema/v2/Decision_Point_Value_Selection-2-0-0.schema.json",
  "description": "This schema defines the structure for selecting SSVC Decision Points and their evaluated values for a given vulnerability. Each vulnerability can have multiple Decision Points, and each Decision Point can have multiple selected values when full certainty is not available.",
  "type": "object",
  "properties": {
    "schemaVersion": {
      "const": "2.0.0",
      "description": "The schema version of this selection list.",
      "title": "Schemaversion",
      "type": "string"
    },
    "target_ids": {
      "description": "Optional list of identifiers for the item or items (vulnerabilities, reports, advisories, systems, assets, etc.) being evaluated by these selections.",
      "examples": [
        [
          "CVE-1900-0000"
        ],
        [
          "VU#999999",
          "GHSA-0123-4567-89ab"
        ]
      ],
      "items": {
        "type": "string"
      },
      "minItems": 1,
      "title": "Target Ids",
      "type": "array"
    },
    "selections": {
      "description": "List of minimal selections made from decision points.",
      "items": {
        "$ref": "#/$defs/MinimalSelection"
      },
      "minItems": 1,
      "title": "Selections",
      "type": "array"
    },
    "timestamp": {
      "description": "Timestamp of when the selections were made, in RFC 3339 format.",
      "examples": [
        "2025-01-01T12:00:00Z",
        "2025-01-02T15:30:45-04:00"
      ],
      "format": "date-time",
      "title": "Timestamp",
      "type": "string"
    }
  },
  "required": [
    "schemaVersion",
    "selections",
    "timestamp"
  ],
  "additionalProperties": false,
  "$defs": {
    "MinimalSelection": {
      "additionalProperties": false,
      "description": "A minimal selection object that contains the decision point ID and the selected options.\nThis is used to transition from an SSVC decision point to a selection.",
      "properties": {
        "namespace": {
          "description": "The namespace of the decision point.",
          "examples": [
            "ssvc",
            "cisa",
            "x_com.example//private",
            "com.example//some-extension",
            "ssvc/de-DE/example.organization/reference-arch-1"
          ],
          "maxLength": 1000,
          "minLength": 3,
          "pattern": "^(?=.{3,1000}$)(?:x_(?!.*[.-]{2,})[a-z][a-z0-9]+(?:[.-][a-z0-9]+)*|(?!.*[.-]{2,})[a-z][a-z0-9]+(?:[.-][a-z0-9]+)*)(?:(?:/(([A-Za-z]{2,3}(-[A-Za-z]{3}(-[A-Za-z]{3}){0,2})?|[A-Za-z]{4,8})(-[A-Za-z]{4})?(-([A-Za-z]{2}|[0-9]{3}))?(-([A-Za-z0-9]{5,8}|[0-9][A-Za-z0-9]{3}))*(-[A-WY-Za-wy-z0-9](-[A-Za-z0-9]{2,8})+)*(-[Xx](-[A-Za-z0-9]{1,8})+)?|[Xx](-[A-Za-z0-9]{1,8})+|[Ii]-[Dd][Ee][Ff][Aa][Uu][Ll][Tt]|[Ii]-[Mm][Ii][Nn][Gg][Oo])/|//)(?!.*[.-]{2,})[a-zA-Z][a-zA-Z0-9]*(?:[.-][a-zA-Z0-9]+)*(?:#[a-zA-Z0-9]+(?:[.-][a-zA-Z0-9]+)*)?(?:/(?!.*[.-]{2,})[a-zA-Z][a-zA-Z0-9]*(?:[.-][a-zA-Z0-9]+)*(?:#[a-zA-Z0-9]+(?:[.-][a-zA-Z0-9]+)*)?)*)?$",
          "title": "Namespace",
          "type": "string"
        },
        "key": {
          "description": "The decision point key.",
          "examples": [
            "E",
            "A",
            "MI",
            "PSI"
          ],
          "minLength": 1,
          "title": "Key",
          "type": "string"
        },
        "version": {
          "description": "The version of the SSVC object. This must be a valid semantic version string.",
          "examples": [
            "1.0.0",
            "2.1.3"
          ],
          "minLength": 5,
          "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
          "title": "Version",
          "type": "string"
        },
        "values": {
          "description": "A list of selected value keys from the decision point values.",
          "examples": [
            [
              "N",
              "Y"
            ],
            [
              "A",
              "B",
              "C"
            ]
          ],
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "title": "Values",
          "type": "array"
        }
      },
      "required": [
        "namespace",
        "key",
        "version",
        "values"
      ],
      "title": "MinimalSelection",
      "type": "object"
    }
  }
}