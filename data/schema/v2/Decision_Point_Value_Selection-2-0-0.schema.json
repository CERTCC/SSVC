{
  "$defs": {
    "MinimalSelection": {
      "description": "A minimal selection object that contains the decision point ID and the selected options.\nThis is used to transition from an SSVC decision point to a selection.",
      "properties": {
        "decision_point_id": {
          "description": "The ID (namespace:key:version) of the decision point from which the selection was made.",
          "title": "Decision Point Id",
          "type": "string"
        },
        "namespace": {
          "description": "The namespace of the decision point.",
          "examples": [
            "ssvc",
            "cisa",
            "certcc"
          ],
          "minLength": 3,
          "title": "Namespace",
          "type": "string"
        },
        "key": {
          "description": "The decision point key.",
          "examples": [
            "E",
            "A",
            "MI",
            "PSI"
          ],
          "minLength": 1,
          "title": "Key",
          "type": "string"
        },
        "version": {
          "description": "The version of the SSVC object. This should be a valid semantic version string.",
          "examples": [
            "1.0.0",
            "2.1.3"
          ],
          "minLength": 5,
          "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
          "title": "Version",
          "type": "string"
        },
        "values": {
          "description": "A list of selected values keys from the decision point values.",
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "title": "Values",
          "type": "array"
        }
      },
      "required": [
        "decision_point_id",
        "namespace",
        "key",
        "version",
        "values"
      ],
      "title": "MinimalSelection",
      "type": "object"
    }
  },
  "description": "This schema defines the structure for selecting SSVC Decision Points and their evaluated values for a given vulnerability. Each vulnerability can have multiple Decision Points, and each Decision Point can have multiple selected values when full certainty is not available.",
  "properties": {
    "schemaVersion": {
      "default": "2.0.0",
      "description": "The schema version of this selection list.",
      "title": "Schemaversion",
      "type": "string"
    },
    "vulnerability_id": {
      "anyOf": [
        {
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Optional vulnerability ID associated with the selections.",
      "examples": [
        "CVE-2025-0000",
        "VU#999999",
        "GHSA-0123-4567-89ab"
      ],
      "title": "Vulnerability Id"
    },
    "selections": {
      "description": "List of minimal selections made from decision points.",
      "items": {
        "$ref": "#/$defs/MinimalSelection"
      },
      "title": "Selections",
      "type": "array"
    },
    "timestamp": {
      "anyOf": [
        {
          "format": "date-time",
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Timestamp of when the selections were made.",
      "title": "Timestamp"
    }
  },
  "type": "object",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://certcc.github.io/SSVC/data/schema/v1/Decision_Point_Value_Selection-1-0-1.schema.json"
}