{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://certcc.github.io/SSVC/data/schema/v2/Decision_Point_Value_Selection-2-0-0.schema.json",
  "description": "This schema defines the structure for selecting SSVC Decision Points and their evaluated values for a given vulnerability. Each vulnerability can have multiple Decision Points, and each Decision Point can have multiple selected values when full certainty is not available.",
  "type": "object",
  "properties": {
    "schemaVersion": {
      "const": "2.0.0",
      "description": "The schema version of this selection list.",
      "title": "Schemaversion",
      "type": "string"
    },
    "vulnerability_id": {
      "anyOf": [
        {
          "minLength": 1,
          "type": "string"
        },
        {
          "type": "null"
        }
      ],
      "default": null,
      "description": "Optional vulnerability ID associated with the selections.",
      "examples": [
        "CVE-2025-0000",
        "VU#999999",
        "GHSA-0123-4567-89ab"
      ],
      "title": "Vulnerability Id"
    },
    "selections": {
      "description": "List of minimal selections made from decision points.",
      "items": {
        "$ref": "#/$defs/MinimalSelection"
      },
      "minItems": 1,
      "title": "Selections",
      "type": "array"
    },
    "timestamp": {
      "description": "Timestamp of when the selections were made, in RFC 3339 format.",
      "examples": [
        "2025-01-01T12:00:00Z",
        "2025-01-02T15:30:45-04:00"
      ],
      "format": "date-time",
      "title": "Timestamp",
      "type": "string"
    }
  },
  "required": [
    "schemaVersion",
    "selections",
    "timestamp"
  ],
  "additionalProperties": false,
  "$defs": {
    "MinimalSelection": {
      "description": "A minimal selection object that contains the decision point ID and the selected options.\nThis is used to transition from an SSVC decision point to a selection.",
      "properties": {
        "namespace": {
          "description": "The namespace of the decision point.",
          "examples": [
            "ssvc",
            "cisa",
            "x_private-test",
            "ssvc/de-DE/reference-arch-1"
          ],
          "maxLength": 1000,
          "minLength": 3,
          "pattern": "^(?=.{3,1000}$)(x_)?[a-z0-9]{3}([/.-]?[a-z0-9]+){0,997}$$",
          "title": "Namespace",
          "type": "string"
        },
        "key": {
          "description": "The decision point key.",
          "examples": [
            "E",
            "A",
            "MI",
            "PSI"
          ],
          "minLength": 1,
          "title": "Key",
          "type": "string"
        },
        "version": {
          "description": "The version of the SSVC object. This must be a valid semantic version string.",
          "examples": [
            "1.0.0",
            "2.1.3"
          ],
          "minLength": 5,
          "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
          "title": "Version",
          "type": "string"
        },
        "values": {
          "description": "A list of selected value keys from the decision point values.",
          "examples": [
            [
              "N",
              "Y"
            ],
            [
              "A",
              "B",
              "C"
            ]
          ],
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "title": "Values",
          "type": "array"
        }
      },
      "required": [
        "namespace",
        "key",
        "version",
        "values"
      ],
      "title": "MinimalSelection",
      "type": "object"
    }
  }
}